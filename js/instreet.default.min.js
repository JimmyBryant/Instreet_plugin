(function(n,o){if(typeof(n.InstreetWidget)!="undefined"||(n.InstreetWidget!=null)){return null}else{n.InstreetWidget={version:"@REVISION@",name:"InstreetWidget"}}var q=n.document,navigator=n.navigator,location=n.location,imgs=[],r=[],prefix="http://push.instreet.cn/",config={cssurl:"http://static.instreet.cn/widgets/push/css/instreet.default.min.css",redurl:prefix+"click.action",callbackurl:prefix+"push.action",murl:prefix+"tracker.action",iurl:prefix+"tracker90.action",ourl:prefix+"loadImage.action",surl:prefix+"share/weiboshare",imih:290,imiw:290,timer:1000},ev={bind:function(a,b,c){if(a.addEventListener){a.addEventListener(b,c,false)}else if(a.attachEvent){a.attachEvent("on"+b,c)}else{a["on"+b]=c}},remove:function(a,b,c){if(a.removeEventListener){a.removeEventListener(b,c,false)}else if(a.datachEvent){a.datachEvent("on"+b,c)}else{a["on"+b]=null}},getEvent:function(a){return a?a:n.event},getTarget:function(a){return a.target||a.srcElement},stopPropagation:function(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}},getRelatedTarget:function(a){if(a.relatedTarget){return a.relatedTarget}else if(a.type=="mouseover"){return a.fromElement}else if(a.type=="mouseout"){return a.toElement}else{return null}},getXY:function(a){var x=0,y=0;if(a.getBoundingClientRect){var b=a.getBoundingClientRect();var D=q.documentElement;x=b.left+Math.max(D.scrollLeft,q.body.scrollLeft)-D.clientLeft;y=b.top+Math.max(D.scrollTop,q.body.scrollTop)-D.clientTop}else{for(;a!=q.body;x+=a.offsetLeft,y+=a.offsetTop,a=a.offsetParent){}};return{x:x,y:y}},aTrim:function(c){var d=new Array();c.sort(sortNum);var e=c.length,flag=0;for(var i=0;i<e;i++){if(c[i]!=c[i+1]){d[flag]=c[i];flag++}}return d;function sortNum(a,b){return a-b}},$:function(a,b,c){var d=a||q;if(q.getElementsByClassName)return d.getElementsByClassName(c);var e=[];var f=b||'*';f=f.toUpperCase();var g=d.getElementsByTagName(f);for(var l=g.length,i=l;i--;){var h=g[i];if(h.className){var k=h.className.replace(/\s/g,'|').split('|');for(var m=k.length,j=m;j--;){if(k[j]==c){e.push(h);break}}}}return e},importFile:function(a,b){var c;switch(a){case"js":c=q.createElement('script');c.src=b;c.charset="utf-8";c.type="text/javascript";break;case"css":c=q.createElement("link");c.type="text/css";c.rel="stylesheet";c.href=b;break}var d=q.getElementsByTagName('head')[0];d.appendChild(c)},getStyle:function(a,b){var c=a.style[b];if(!c){if(q.defaultView&&q.defaultView.getComputedStyle){var d=q.defaultView.getComputedStyle(a,null);c=d?d.getPropertyValue(b):null}else{if(a.currentStyle){c=a.currentStyle[b]}}}if(b=="opacity"){try{c=a.filters['DXImageTransform.Microsoft.Alpha'].opacity;c=c/100}catch(e){try{c=a.filters('alpha').opacity}catch(err){}}}return c},hasClass:function(a,c){if(a&&a.className){var b=new RegExp(c);return b.test(a.className)}return false}};var $=function(a){return q.getElementById(a)},each=function(a,b){if(a.length){for(var i=0,len=a.length;i<len;i++){b.call(a[i],i)}}else{a&&b.call(a,0)}},hide=function(a){each(a,function(){this.style.display="none"})},show=function(a){each(a,function(){this.style.display="block"})};var r=[];var s=function(){for(var i=0;i<r.length;i++)r[i]&&r[i]()};var u=function(){try{q.documentElement.doScroll('left')}catch(err){setTimeout(u,1);return}s()};q.DomReady=function(a){var b=!!n.ActiveXObject;if(q.readyState==="complete"){r.push(a);s();return}if(r.push(a)>1)return;if(q.addEventListener)return q.addEventListener('DOMContentLoaded',s,false);if(b){u()}};var v=function(a){var b=a.img,src=a.src,w=400,h=300,createMedia=function(){var e=q.createElement("embed");e.type="application/x-shockwave-flash";e.quality="high";return e},createContainer=function(){var e=q.createElement("div");e.className="instreet-video-wrap";return e};this.container=createContainer();this.video=createMedia();this.video.width=w;this.video.height=h;this.height=h;this.img=b;this.video.src=src};v.prototype={watch:function(){var a=this,container=$('instreet-plugin-container'),wrap=this.container,str,pos=ev.getXY(a.img),w=a.img.width,padTop=Math.round(a.img.height-a.height)/2<0?0:Math.round(a.img.height-a.height)/2,h=a.img.height-padTop;wrap.style.cssText="position:absolute;text-align: center;padding-top:"+padTop+"px;top:"+pos.y+"px;left:"+pos.x+"px;background:#FFF;z-index:100010;opacity:.5;filter:alpha(opacity=50);width:"+w+"px;height:"+h+"px;";var b=q.createElement("a");b.href="javascript:;";b.style.cssText="display:inline-block;text-decoration:none;background:#000;font-size:14px;font-weight:bold;width:25px;height:25px;vertical-align:top;line-height:27px;color:#FFF;";b.title="关闭视频";b.innerHTML="×";b.onclick=function(){var c=this.parentNode,p=c.parentNode||q.body;p.removeChild(c)};wrap.appendChild(a.video);wrap.appendChild(b);container.appendChild(wrap)},close:function(){var a=this.container.parentNode||q.body;a.removeChild(this.container)}};var z=(function(d,e){var f=null,list=[];var g=function(a,b){this.elem=a;this.speed=b||300;this.flag=null;this.height=a.clientHeight;a.style.height=0};g.prototype.slideDown=function(a){var b=this,d=b.elem,e=b.speed,startTime=new Date().getTime(),now=d.clientHeight,gap=b.height-now;d.style.display="block";var c=function(){var p=(new Date().getTime()-startTime)/e,swing=(-Math.cos(p*Math.PI)/2)+0.5;d.style.height=now+(gap*swing)+'px';if(p<=1){clearTimeout(b.flag);b.flag=setTimeout(c,30)}else{a&&a()}};c()};g.prototype.slideUp=function(a){var b=this,d=b.elem,e=b.speed,startTime=new Date().getTime(),now=d.clientHeight,gap=-now;var c=function(){var p=(new Date().getTime()-startTime)/e,swing=(-(Math.cos(p*Math.PI)/2)+0.5);d.style.height=now+Math.floor(gap*swing)+'px';if(p<=1){clearTimeout(b.flag);b.flag=setTimeout(c,30)}else{a&&a()}};c()};g.prototype.stop=function(){clearTimeout(this.flag);this.flag=null};return g})();var A={adsArray:[],initData:function(){var a=q.getElementsByTagName('img');for(var i=0,len=a.length;i<len;i++){var b=a[i];imgs[i]=b;b.insId=i;b.setAttribute("instreet-img-id",i);A.onImgLoad(b)}},onImgLoad:function(b){var c=new Image();c.src=b.src,c.insId=b.insId;if(c.complete){A.loadData(c)}else{c.onload=function(){var a=this;a.onload=null;A.loadData(c)}}},loadData:function(a){var b=a.insId,clientImg=imgs[b];if(a.width>=config.imiw&&a.height>=config.imih){if(clientImg.clientWidth>=config.imiw&&clientImg.clientHeight>=config.imih){B.recordImage(clientImg);if(typeof config.adsLimit=="number"&&config.adsLimit<=0){return}A.createJsonp(clientImg);config.adsLimit&&config.adsLimit--}}},createJsonp:function(a){var w=a.clientWidth,h=0,pu=encodeURIComponent(encodeURIComponent(location.href));var b=encodeURIComponent(encodeURIComponent(a.src)),url=config.callbackurl+"?index="+a.insId+"&pu="+pu+"&pd="+config.widgetSid+"&iu="+b+"&callback=insjsonp&w="+w+"&h="+h;ev.importFile('js',url)}};var B={container:null,widgetBox:null,init:function(){var a=config.cssurl;ev.importFile('css',a);B.createContainer();B.bindEvents()},createContainer:function(){var a=q.createElement('div');a.id="instreet-plugin-container";B.container=a;q.body.insertBefore(a,q.body.firstChild);B.createWidgetBox()},createWidgetBox:function(){var a=q.createDocumentFragment(),shop=q.createElement("div"),weibo=q.createElement("div"),wiki=q.createElement("div");shop.className="shop-holder";weibo.className="weibo-holder";wiki.className="wiki-holder";a.appendChild(shop);a.appendChild(weibo);a.appendChild(wiki);B.container.appendChild(a);B.shop=shop;B.weibo=weibo;B.wiki=wiki},bindEvents:function(){var b=B.shop,weibo=B.weibo,wiki=B.wiki,index;B.container.onclick=function(e){var a=ev.getEvent(e),tar=ev.getTarget(a);if(tar.className=="button-close-holder"){hide(tar.parentNode.parentNode)}};b.onmouseover=function(e){index=this.insId;var a=ev.getEvent(e),rela=ev.getRelatedTarget(a),ad=A.adsArray[index];ad.showWidget();show(this);if(!B.shop.contains(rela)){ad.recordWatch(this)}};b.onmouseout=function(e){B.leaveApp(e,this.insId,this)};weibo.onmouseover=function(e){index=this.insId;var a=ev.getEvent(e),rela=ev.getRelatedTarget(a),ad=A.adsArray[index];ad.showWidget();show(this);if(!B.weibo.contains(rela)){ad.recordWatch(this)}};weibo.onmouseout=function(e){B.leaveApp(e,this.insId,this)};wiki.onmouseover=function(e){index=this.insId;var a=ev.getEvent(e),rela=ev.getRelatedTarget(a),ad=A.adsArray[index];ad.showWidget();show(this);if(!B.wiki.contains(rela)){ad.recordWatch(this)}};wiki.onmouseout=function(e){B.leaveApp(e,this.insId,this)}},hideApps:function(){hide(B.shop);hide(B.weibo);hide(B.wiki)},enterApp:function(e,a,b){var c=ev.getEvent(e),rela=ev.getRelatedTarget(e),ad=A.adsArray[a];ad.showWidget();show(b);if(!B.shop.contains(rela)){ad.recordWatch(b)}},leaveApp:function(e,a,b){var c=ev.getEvent(e),rela=ev.getRelatedTarget(c);var d=A.adsArray[a];d.hideWidget();hide(b);if(!B.container.contains(rela)&&rela!==d.img){d.hideAd()}},recordImage:function(a){var b=encodeURIComponent(encodeURIComponent(a.src)),pd=config.widgetSid,pu=encodeURIComponent(encodeURIComponent(location.href)),t=encodeURIComponent(encodeURIComponent(q.title)),ul=config.ourl;var c=new Date().getTime();ul+="?iu="+b+"&pd="+pd+"&pu="+pu+"&t="+t+"&time="+c;ev.importFile('js',ul)}};var C=function(a){var b=imgs[a.index];this.data=a;this.originInfo={width:b.clientWidth,height:b.clientHeight,src:b.src,pos:ev.getXY(b)};this.img=b;this.init()};C.prototype={constructor:C,init:function(){var a=this;a.createAll();a.locate();a.bindEvents()},createAll:function(){var a=this,boxWrapper=q.createElement("div"),spotHolder=q.createElement("div");boxWrapper.className="instreet-box-wrapper";spotHolder.className="spot-holder";B.container.appendChild(boxWrapper);boxWrapper.appendChild(spotHolder);a.boxWrapper=boxWrapper;a.spotHolder=spotHolder;a.createIconsHolder();a.createSpots();a.createAd()},locate:function(){var a=this,spots=a.spotHolder.children,icons=a.icons,ad=a.ad,img=a.img,pos=ev.getXY(img),icons_left,icons_top,imgW=img.offsetWidth,imgH=img.offsetHeight,pad=2;var b=a.data.badsSpot.length?"none":"block";icons_left=config.position=="left"?pos.x+pad+"px;":pos.x+imgW-icons.offsetWidth-pad+"px;";icons_top=pos.y+imgH-icons.offsetHeight+"px;";icons.style.cssText="left:"+icons_left+"top:"+icons_top+"display:"+b;for(var c=spots.length,i=0;i<c;i++){var d=spots[i];var e=a.getCoor(d);d.style.cssText="top:"+e.top+"px;left:"+e.left+"px;"}},detect:function(){var a=this,img=a.img,origin=a.originInfo,side=a.sideWrapper,pos=ev.getXY(img);if(img.src&&img.src!=origin.src){var b=side.parentNode||q.body;b.removeChild(side);A.onImgLoad(img);origin.src=img.src}else if(img.clientWidth!=origin.width||img.clientHeight!=origin.height){if(img.clientWidth==0||img.clientHeight==0){var c=q.images;for(var i=c.length;i--;){if(c[i].src==img.src&&img!==c[i]){c[i].insId=img.insId;a.img=c[i]}}}a.locate()}else if(pos.x!==origin.pos.x||pos.y!==origin.pos.y){origin.pos=pos;a.locate()}},bindEvents:function(){var d=this,box=d.boxWrapper,icons=d.icons,img=d.img,shareIcon=icons.lastChild.children[1],spotHolder=d.spotHolder,ad=d.ad;box.onclick=function(e){var a=ev.getEvent(e),tar=ev.getTarget(a);if(tar.className=="icon-logo"){if(d.stopMouseover){d.showWidget();d.stopMouseover=false}else{d.hideWidget();B.hideApps();d.hideAd();d.stopMouseover=true}}else if(tar.parentNode.className.match("instreet-share-icons")){var b=d.img,data=d.data,picUrl=encodeURIComponent(b.src),shareTo=tar.className.replace("instreet-",""),widgetSid=data.widgetSid,url=encodeURIComponent(location.href),title=encodeURIComponent(q.title),recordUrl=config.surl+"?content=''&imgUrl="+picUrl+"&widgetSid="+widgetSid+"&pageUrl="+url+"&shareTo="+shareTo;ev.importFile('js',recordUrl);var c="toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=580, height=500";switch(tar.className){case"instreet-sina":n.open('http://v.t.sina.com.cn/share/share.php?title='+title+'&url='+url+'&pic='+picUrl,"_blank",c);break;case"instreet-renren":n.open('http://share.renren.com/share/buttonshare.do?link='+url,"_blank",c);break;case"instreet-tx":n.open('http://share.v.t.qq.com/index.php?c=share&a=index&title='+title+'&url='+url+'&pic='+picUrl,"_blank",c);break}}};if(typeof ad!="undefined"){ad.onclick=function(e){var a=ev.getEvent(e),tar=ev.getTarget(a);if(tar.className=="button-close-ad"){d.adClosed=false;d.hideAd()}};ad.onmouseover=function(e){var a=ev.getEvent(e),rela=ev.getRelatedTarget(a);if(!this.contains(rela)){d.recordWatch(this)}}};box.onmouseover=function(e){var a=ev.getEvent(e),rela=ev.getRelatedTarget(a);!d.stopMouseover&&d.showWidget();if(rela!==img){!d.stopMouseover&&d.showAd()}};box.onmouseout=function(e){var a=ev.getEvent(e),rela=ev.getRelatedTarget(a);d.hideWidget();if(!B.container.contains(rela)&&rela!==img){d.hideAd()}};shareIcon.onmouseover=function(){show(this.lastChild)};shareIcon.onmouseout=function(){hide(this.lastChild)};ev.bind(img,"mouseover",function(e){var a=ev.getEvent(e),rela=ev.getRelatedTarget(a);!d.stopMouseover&&d.showWidget();if(!B.container.contains(rela)){d.recordShow(10);!d.stopMouseover&&d.showAd()}});ev.bind(img,"mouseout",function(e){var a=ev.getEvent(e),rela=ev.getRelatedTarget(a);d.hideWidget();!box.contains(rela)&&B.hideApps();if(!B.container.contains(rela)){d.hideAd()}});spotHolder.onmouseover=function(e){var a=ev.getEvent(e),tar=ev.getTarget(a);if(tar.className=="instreet-spot-shop"&&B.shop.display!=="block"){d.recordShow(9,tar)}B.hideApps();d.showApp(tar)}},createIconsHolder:function(){var a=q.createElement("div"),str='';a.className="icons-holder";str='<a class="icon-logo" href="javascript:;" title="尚街网"></a><dl class="tool-bar"><dd><a class="icon-meiding" target="-blank" href="http://www.imeiding.com?ufrom=ad"></a></dd><dd><a class="icon-share" href="javascript:;" title="分享"></a><div class="instreet-share-icons right" instreet-img-id="5"><a class="instreet-sina" title="分享到新浪微博" href="javascript:;"></a><a class="instreet-renren" href="javascript:;" title="分享到人人网"></a><a class="instreet-tx" title="分享到腾讯微博" href="javascript:;"></a></div></dd><dd><a class="icon-logo" href="javascript:;" title="尚街网"></a></dd></dl>';a.innerHTML=str;this.boxWrapper.appendChild(a);this.icons=a},createSpots:function(){var a=this,container=B.container,data=a.data,index=parseInt(data.index),wrapper=a.wrapper,w,metrixArray=[],i,len,w,spot;if(config.showAd){for(i=0,len=data.adsSpot.length;i<len;i++){var b=data.adsSpot[i];metrixArray.push(parseInt(b.metrix))}metrixArray=ev.aTrim(metrixArray);for(i=0,len=metrixArray.length;i<len;i++){w=data.adsSpot[0].width;a.createSpot({metrix:metrixArray[i],width:w},"shop")}}if(config.showWeibo){for(i=0,len=data.weiboSpot.length;i<len;i++){w=data.weiboSpot[0].width;a.createSpot({metrix:data.weiboSpot[i].metrix,width:w},"weibo")}}if(config.showWiki){for(i=0,len=data.wikiSpot.length;i<len;i++){w=data.wikiSpot[0].width;a.createSpot({metrix:data.wikiSpot[i].metrix,width:w},"wiki")}}},createSpot:function(a,b){if(b&&a){var c=q.createElement('a');c.className="instreet-spot-"+b;c.href="javascript:;";c.metrix=a.metrix;c.originWidth=a.width;this.spotHolder.appendChild(c)}},createAd:function(){var a=this,data=a.data,index=data.index,img=a.img,pos=ev.getXY(img),height=img.offsetHeight,width=img.offsetWidth,h=100,w=300,str='';if(config.showFootAd&&data.badsSpot.length>0){var b=data.badsSpot[0],ad=q.createElement('div'),aw=!!b.adsWidth?b.adsWidth+"px;":"auto;",ah=!!b.adsHeight?b.adsHeight+"px;":"auto;";ad.className='ad-holder';str='<div class="ad-cont" style="width:'+aw+'height:'+ah+'"><a class="button-close-ad" title="关闭" href="javascript:;">×</a>';var c=config.redurl+"?tty=0&mx=&muh="+data.imageUrlHash+"&pd="+data.widgetSid+"&ift=&at="+(b.adsType||'')+"&ad="+(b.adsId||'')+"&rurl="+encodeURIComponent(encodeURIComponent(b.adsLinkUrl||''));if(b.adsType=='3'){str+='<a href="'+c+'" class="imgbox" target="_blank"><img class="adimg" src="'+b.adsPicUrl+'" alt=""/></a>'}else if(b.adsType=='8'){str+="<img src='"+b.adsPicUrl+"'  media-src='"+b.description+"' class='instreet-video-trigger' alt='' style='cursor:pointer;'/>"}else if(b.adsType=='9'){str+="<a href='"+c+"' target='_blank'><embed wmode='transparent' width='300' height='100'  src='"+b.adsPicUrl+"' type='application/x-shockwave-flash'></embed></a>"}else if(b.adsType=='2'){h=35;w=width-32;var d=b.adsPicUrl.split(','),pt=30;ad.setAttribute("width",w);ad.setAttribute("height",h+pt);ad.style.cssText="width:"+w+"px;height:"+h+"px;left:"+pos.x+"px;top:"+(pos.y+height-h-pt)+"px;padding-top:30px;";if(w>375){str+="<a href='"+c+"' class='black-bg' target='-blank'><img class='sprite1' src='"+(d[0]||"")+"' alt=''/><span class='slogan'><p class='light'>"+footAd.adsTitle+"</p><p>更多精彩»</p></span></a>"}else{str+="<a href='"+c+"' class='black-bg' target='-blank'><span class='slogan'><p class='light'>"+footAd.adsTitle+"</p><p>更多精彩»</p></span></a>"}}else if(!b.adsLinkUrl&&b.description){var e=b.description;str+=e.slice(0,-2)+'></iframe>'}str+="</div>";ad.innerHTML=str;a.boxWrapper.appendChild(ad);a.ad=ad}},getCoor:function(a){var b=this,img=b.img,metrix=a.metrix,ox=metrix%3000,oy=Math.round(metrix/3000),w=a.originWidth,zoomNum=img.width/w,x=ox*zoomNum,y=oy*zoomNum,pos=ev.getXY(img);return{top:(y+pos.y),left:(x+pos.x)}},showWidget:function(){var a=this,spots=a.spotHolder,icons=a.icons;show(icons.lastChild);spots.children.length&&show(spots.children);icons.style.zIndex=100000},hideWidget:function(){var a=this,spots=a.spotHolder,icons=a.icons;hide(icons.lastChild);spots.children.length&&hide(spots.children);icons.style.zIndex=99999},showAd:function(){var a=this,ad=a.ad,img=a.img,pos=ev.getXY(img),imgW=img.offsetWidth,imgH=img.offsetHeight;if(ad&&ad.style.display!="block"){show(ad);var b=ad.lastChild.offsetWidth,adH=100;ad.style.cssText="display:block;left:"+(pos.x+(imgW-b)/2)+"px;top:"+(pos.y+imgH-adH)+"px;width:"+b+"px;height:"+adH+"px";if(!a.slider){a.adClosed=true;a.slider=new z(ad.lastChild)}if(a.adClosed){a.slider.stop();a.slider.slideDown()}}},hideAd:function(){var a=this,ad=a.ad;if(ad&&ad.style.display=="block"){a.slider.stop();a.slider.slideUp(function(){hide(ad);a.adClosed=true})}},showApp:function(a){var b=this,data=b.data,cn=a.className,appBox,metrix=a.metrix,str="",pos={x:parseInt(a.style.left),y:parseInt(a.style.top)},size=25;str+="<h2 class='cont-head'><a class='button-close-holder' href='javascript:;' title='关闭'>×</a></h2>";switch(cn){case"instreet-spot-shop":appBox=B.shop;appBox.style.cssText="left:"+(pos.x+size)+"px;top:"+(pos.y+size)+"px;display:block";var c=0;if(appBox.metrix==metrix)return;appBox.metrix=metrix;appBox.insId=b.img.insId;for(var i=0,len=data.adsSpot.length;i<len;i++){var d=data.adsSpot[i],redUrl=config.redurl+"?tty=0&mx="+d.metrix+"&muh="+data.imageUrlHash+"&pd="+d.widgetSid+"&ift=&at="+d.adsType+"&ad="+d.adsId+"&rurl="+encodeURIComponent(encodeURIComponent(d.adsLinkUrl));if(d.metrix==metrix){str+="<div class='cont-body' id='instreet-shop-focus' adsid='"+d.adsId+"' index='"+c+"'><div class='left'><a class='thumb' target='-blank' href='"+redUrl+"' title='"+d.adsTitle+"'><img src='"+d.adsPicUrl+"'/></a></div><div class='right'><p class='p-desc'><a target='-blank' href='"+redUrl+"'>"+d.adsTitle+"</a></p>";str+="<p class='p-money'>原价：<strong>"+d.adsPrice+"</strong></p><p class='p-nowmoney'>现价：<strong>"+(d.adsDiscount||d.adsPrice)+"</strong></p>";str+="<p class='p-buyit'><a class='button-buy' href='"+redUrl+"' target='-blank'></a></p></div><div class='clear'></div></div>"}}appBox.innerHTML=str;break;case"instreet-spot-weibo":appBox=B.weibo;appBox.style.cssText="left:"+(pos.x+size)+"px;top:"+(pos.y+size)+"px;display:block";if(appBox.metrix==metrix)return;appBox.metrix=metrix;appBox.insId=b.img.insId;for(var i=0,len=data.weiboSpot.length;i<len;i++){var d=data.weiboSpot[i],title=d.title,nickName=d.nickName,icon=d.icon,avatar=d.avatar,latestStatus=d.latestStatus,redUrl=config.redurl+"?tty=1&mid="+data.imageNumId+"&muh="+data.imageUrlHash+"&pd="+data.widgetSid+"&ift="+d.type+"&at=&ad=&tg="+encodeURIComponent(encodeURIComponent(title))+"&rurl="+encodeURIComponent(encodeURIComponent(d.userUrl));if(d.metrix==metrix){str+="<div class='cont-body'><div class='left'><a class='thumb' target='-blank' href='"+redUrl+"' title='"+nickName+"'><img src='"+avatar+"'/></a></div><div class='right'><p class='summary'><a class='nickname' target='-blank' href='"+redUrl+"'>"+nickName+"</a>："+latestStatus+"</p><p class='icon'><a target='-blank' href='"+redUrl+"' title='微博'><img src='"+icon+"'/></a></p></div><div class='clear'></div></div>"}}appBox.innerHTML=str;break;case"instreet-spot-wiki":appBox=B.wiki;appBox.style.cssText="left:"+(pos.x+size)+"px;top:"+(pos.y+size)+"px;display:block";if(appBox.metrix==metrix)return;appBox.metrix=metrix;appBox.insId=b.img.insId;for(var i=0,len=data.wikiSpot.length;i<len;i++){var d=data.wikiSpot[i],title=d.title,firstimg=d.firstimg,summary=d.summary,redUrl=config.redurl+"?tty=1&mid="+data.imageNumId+"&muh="+data.imageUrlHash+"&pd="+data.widgetSid+"&ift="+d.type+"&at=&ad=&tg="+encodeURIComponent(encodeURIComponent(title))+"&rurl="+encodeURIComponent(encodeURIComponent(d.url));if(d.metrix==metrix){str+="<div class='cont-body'><div class='left'><a class='thumb' target='-blank' href='"+redUrl+"' title='"+title+"'><img src='"+firstimg+"'/></a></div><div class='right'><p><a class='nickname' target='-blank' href='"+redUrl+"'>"+title+"</a></p><p class='summary'>"+summary+"</p><p class='icon'><a target='-blank' href='"+redUrl+"' title='互动百科'><img src='http://static.instreet.cn/widgets/push/images/icon-baike.png'/></a></p></div><div class='clear'></div></div>"}}appBox.innerHTML=str;break}},recordShow:function(a,b){var c=this,data=c.data,img=c.img,ul=config.iurl,pd=data.widgetSid,muh=data.imageUrlHash,iu=encodeURIComponent(encodeURIComponent(img.src));var d="",adsType="",mx="";if(a==9&&b){var e=b.metrix;for(var i=0,len=data.adsSpot.length;i<len;i++){var f=data.adsSpot[i];if(f.metrix==e){d+=d==""?f.adsId:","+f.adsId;adsType+=adsType==""?f.adsType:","+f.adsType;mx=f.metrix}}}else if(a==10&&c.ad){d=data.badsSpot[0].adsId;adsType=data.badsSpot[0].adsType}var g=new Date().getTime();ul+="?pd="+pd+"&muh="+muh+"&mx="+mx+"&iu="+iu+"&ad="+d+"&at="+adsType+"&flag="+a+"&time="+g;ev.importFile('js',ul)},recordWatch:function(a){var b=this,data=b.data,img=b.img,iu=encodeURIComponent(encodeURIComponent(img.src)),pd=data.widgetSid,ul=config.murl,mid=data.imageNumId||'',muh=data.imageUrlHash,adData,ad='',at='',tg='',ift=0,tty=1,mx='';var c=a.className.replace("-holder","");if(c=="shop"){var d=B.shop.metrix;for(var i=0,len=data.adsSpot.length;i<len;i++){var e=data.adsSpot[i];if(e.metrix==d){ad+=ad==""?e.adsId:","+e.adsId;at+=at==""?e.adsType:","+e.adsType}}tty=0;mx=d}else if(c=="weibo"){ift=2;var d=B.weibo.metrix;for(var i=0,len=data.weiboSpot.length;i<len;i++){var e=data.weiboSpot[i];mx=d}}else if(c=="wiki"){ift=4;var d=B.wiki.metrix;for(var i=0,len=data.wikiSpot.length;i<len;i++){var e=data.wikiSpot[i];mx=d}}else if(c=="ad"){ad=data.badsSpot[0].adsId;at=data.badsSpot[0].adsType;tty=0}else{return}var f=new Date().getTime();ul+="?iu="+iu+"&pd="+pd+"&muh="+muh+"&ad="+ad+"&mid="+mid+"&at="+at+"&tty="+tty+"&ift="+ift+"&mx="+mx+"&time="+f;ev.importFile('js',ul)}};C.reLocate=function(){var a=A.adsArray;for(i in a){var b=a[i];b.locate&&b.locate()}};n['insjsonp']=function(a){if(a){var b=a.index,img=imgs[b];img.setAttribute('instreet-data-ready',true);A.adsArray[b]=new C(a);if(config.footAuto){var c=A.adsArray[b];c.showAd();c.ad&&c.recordShow(9,null)}}};var E=(function(){var b=null;return function(a){b=setInterval(function(){for(var i=0;i<a.length;i++){a[i]&&a[i].detect()}},1000)}})();var F=function(c){if(c&&typeof c=="object"){for(var i in c){config[i]=c[i]}}else{return}};var G=function(){if(typeof instreet_config!="undefined"){F(instreet_config)}B.init();A.initData();ev.bind(n,'resize',function(){C.reLocate()});E(A.adsArray)};q.DomReady(function(){G()})})(window);
